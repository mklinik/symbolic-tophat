% !TEX root=main.tex


%% Language %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newmacro{O-Value}{
  \begin{function}
    \signature{\Value : \mathrm{Tasks} \times \mathrm{States} \rightharpoonup \mathrm{Values}} \\
    \Value(\Edit \bar{v}, s)          &=& \bar{v} \\
    \Value(\Enter \tau, s)            &=& \bot \\
    \Value(\Update l, s)              &=& s(l) \\
    \Value(\Fail, s)                  &=& \bot \\
    \Value(t_1 \Then e_2, s)          &=& \bot \\
    \Value(t_1 \Next e_2, s)          &=& \bot \\
    \Value(t_1 \And t_2, s)           &=& \left\{
      \begin{array}{ll}
        \tuple{\bar{v}_1, \bar{v}_2}  & \ \when\ \Value(t_1, s) = \
        \bar{v}_1 \land \Value(t_2, s) = \bar{v}_2 \\
        \bot                          & \ \otherwise
      \end{array}
    \right. \\
    \Value(t_1 \Or t_2, s)            &=& \left\{
      \begin{array}{ll}
        \bar{v}_1                           & \ \when\ \Value(t_1, s) = \bar{v}_1 \\
        \bar{v}_2                           & \ \when\ \Value(t_1, s) = \bot \land \Value(t_2, s) = \bar{v}_2 \\
        \obox{\tuple{\bar{v}_1, \bar{v}_2}}{\bot} & \ \otherwise
      \end{array}
    \right. \\
    \Value(t_1 \Xor t_2, s)           &=& \bot
  \end{function}
}

\newmacro{O-Failing}{
  \begin{function}
    \signature{\Failing : \mathrm{Tasks} \times \mathrm{States} \to \mathrm{Booleans}} \\
    \Failing(\Edit \bar{v},s) &=& \False \\
    \Failing(\Enter \tau,s)   &=& \False \\
    \Failing(\Update l,s)     &=& \False \\
    \Failing(\Fail,s)         &=& \True \\
    \Failing(t_1 \Then e_2,s) &=& \Failing(t_1,s) \\
    \Failing(t_1 \Next e_2,s) &=& \Failing(t_1,s) \\
    \Failing(t_1 \And t_2,s)  &=& \Failing(t_1,s) \land \Failing(t_2,s) \\
    \Failing(t_1 \Or t_2,s)   &=& \Failing(t_1,s) \land \Failing(t_2,s) \\
    \Failing(e_1 \Xor e_2,s)  &=& \Failing(t_1,s_1') \land \Failing(t_2,s_2') \quad\where\ e_1,s \symnormalise t_1,s_1' \mathbf{\ and\ } e_2,s \symnormalise t_2,s_2'
  \end{function}
}
